<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="CountDownGame.Pages.GamePage"
             Title="Game">
    <ScrollView>
        <VerticalStackLayout Padding="24" Spacing="14">

            <!-- Title -->
            <Label Text="Countdown — Game" FontSize="24" HorizontalOptions="Center" />

            <!-- Dictionary status -->
            <Label Text="{Binding DictionaryStatus}" FontAttributes="Italic" />

            <!-- Who picks letters this round -->
            <Label Text="{Binding PickerDisplay}" FontAttributes="Italic" />

            <!-- Round + timer -->
            <Label Text="{Binding RoundDisplay}" FontAttributes="Bold" />
            <Label Text="{Binding TimerDisplay}" FontSize="22" HorizontalOptions="Center" />

            <!-- Healthbar-style timer (drains from full → empty, green) -->
            <Frame Padding="0" HeightRequest="14" CornerRadius="7"
                   BackgroundColor="#32CD32" HasShadow="False">
                <ProgressBar Progress="{Binding TimerProgress}"
                             ProgressColor="LimeGreen"
                             Margin="0" HeightRequest="14" />
            </Frame>

            <!-- Players -->
            <Grid ColumnDefinitions="*,*" ColumnSpacing="12">
                <VerticalStackLayout Grid.Column="0" Spacing="6">
                    <Entry Placeholder="Player 1 Name" Text="{Binding Player1Name}" />
                    <Label Text="{Binding Player1Score, StringFormat='Score: {0}'}" />
                </VerticalStackLayout>
                <VerticalStackLayout Grid.Column="1" Spacing="6">
                    <Entry Placeholder="Player 2 Name" Text="{Binding Player2Name}" />
                    <Label Text="{Binding Player2Score, StringFormat='Score: {0}'}" />
                </VerticalStackLayout>
            </Grid>

            <!-- Letters tray -->
            <HorizontalStackLayout Spacing="8"
                                   BindableLayout.ItemsSource="{Binding Letters}">
                <BindableLayout.ItemTemplate>
                    <DataTemplate>
                        <Frame Padding="10" HasShadow="True" CornerRadius="10">
                            <Label Text="{Binding .}" FontSize="24" HorizontalOptions="Center"/>
                        </Frame>
                    </DataTemplate>
                </BindableLayout.ItemTemplate>
            </HorizontalStackLayout>
            <Label Text="{Binding LettersCountDisplay}" />

            <!-- Letter controls -->
            <Grid ColumnDefinitions="*,*" ColumnSpacing="12">
                <Button Grid.Column="0" Text="Consonant"
                        Command="{Binding AddConsonantCommand}"
                        IsEnabled="{Binding CanPickLetters}" />
                <Button Grid.Column="1" Text="Vowel"
                        Command="{Binding AddVowelCommand}"
                        IsEnabled="{Binding CanPickLetters}" />
            </Grid>
            <Button Text="Clear Letters"
                    Command="{Binding ClearLettersCommand}"
                    IsEnabled="{Binding CanClearLetters}" />

            <!-- Start round -->
            <Button Text="Start Round"
                    Command="{Binding StartRoundCommand}"
                    IsEnabled="{Binding StartEnabled}" />

            <!-- Entry phase (after timer) -->
            <VerticalStackLayout Spacing="10" IsVisible="{Binding IsEntryPhase}">
                <Label Text="Time! Enter words:" FontAttributes="Bold" />
                <Entry Placeholder="Player 1 word" Text="{Binding Player1WordInput}" />
                <Entry Placeholder="Player 2 word" Text="{Binding Player2WordInput}" />
                <Button Text="Score Round"
                        Command="{Binding ScoreRoundCommand}"
                        IsEnabled="{Binding CanScore}" />
            </VerticalStackLayout>

            <!-- Status -->
            <Label Text="{Binding StatusMessage}" />

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
